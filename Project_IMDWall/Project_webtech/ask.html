<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<!--<link rel="stylesheet" type="text/css" href="reset.css">
	<link rel="stylesheet" type="text/css" href="css.css"> -->
	<title>IMDWall</title>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	<script src="/socket.io/socket.io.js"></script>
	<style>
	.questions{
		min-height: 500px;
		width: 500px;
		margin: auto;
		font-size: 1.6em;
		border: 1px solid black;
	}
	#send-question{
		float: left;
	}
	#contentWrap{
		display: none;
	}
	#users{
		float:left;
			}
	</style>
</head>
<body>
<h1>Stel uw vraag</h1>

	<div id="nickWrap">
		<p>Enter a username:</p>
		<p id="nickError"></p>
		<form action="" id="setNick">
			<input type="text" id="nickname">
			<input type="submit"></input>
		</form>
	</div>

	<div id="contentWrap">
		<div id="chatWrap">
			<div class="questions"></div>
			<form id="send-question">
				<input type="text" size="35" id="question">
				<input type="submit" value="ask"></input>
			</form>
		</div>
		<div id="users"></div>
	</div>
	<script>
	jQuery(function($){
		var socket = io.connect();
		var $nickForm = $('#setNick');
		var $nickError = $('#nickError');
		var $nickBox = $('#nickname');
		var $users = $('#users');
		var $messageForm = $('#send-question');
		var $messageBox = $('#question');
		var $ask = $('.questions');

		$nickForm.submit(function(e){
			e.preventDefault();
			socket.emit('new user', $nickBox.val(), function(data){
				if(data){
					$('#nickWrap').hide();
					$('#contentWrap').show();
				} else{
					$nickError.html('Username is already taken! Try again.')
				}
			});
			$nickBox.val('');
		});

		$messageForm.submit(function(e){
			e.preventDefault();
			socket.emit('send message', $messageBox.val());
			$messageBox.val('');
		});

		socket.on('usernames', function(data){
			var html = '';
			for(i=0; i < data.length; i++){
				html += data[i] + '<br />';
			}
			$users.html(html);
		});

		socket.on('new message', function(data){
			$ask.append('<b>' + data.nick + ': </b>'  + data.msg + "<br />");
		});


	});
	</script>
</body>
</html>